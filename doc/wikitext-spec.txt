= Motivation =

WikiText is an attempt to specify a very simple text markup protocol,
that retains readability and adheres to formatting conventions
commonly found in text based communication, such as email or irc.

WikiText formatted documents strive to be easily readable by humans,
judiciously using whitespace and special characters for formatting,
and not cluttering the text with an abundance of markup tags.

WikiText documents can be converted to other formats, such as HTML,
with relative ease.


= Overview =

A WikiText document consists of sections, environments, and
paragraphs.  Sections define the coarsest structure of the document,
and can contain environments and paragraphs.  Environments define the
finer structure of the document, and can contain other environments
and paragraphs.  Paragraphs are the basic elements of a document, and
contain the actual text, associated with a certain meaning.


= Document Structure =

Documents can be divided into sections.  Each section consists of a
heading and a list of environments or paragraphs.  A section extends
from its heading to the beginning of the next section, or the end of
the document.

Environments further subdivide the sections of the document.
Environments can nest, thus forming a tree structure.  Nesting is
controlled by indentation.  Environments are nested into the last
opened environment with less indentation.  Paragraphs are nested into
the last opened environment with less or equal indentation.

Four different environments are defined:

  o Quotations,
  o Listings,
  o Enumerations, and
  o Descriptions.

Three types of paragraphs, and three types of special, paragraph-like
blocks are defined:

  o Normal paragraphs,
  o Preformatted text blocks, and
  o Code blocks.

The three special blocks are

  o Tables,
  o Horizontal rules, and
  o Verbatim blocks.

Text in normal paragraphs and preformatted text blocks can be
formatted with inline markup.  Inline markup is defined for

  o Emphasis,
  o Strong,
  o Underline,
  o Strikethrough, and
  o Typewriter font.


== Inline Markup ==

=== Text Formatting ===

Text formatting tags must enclose the formatted text without
intermediate whitespace.  The opening character must be preceded by
whitespace, an opening senctence character ("(", "Â¿", etc) or the
beginning-of-paragraph, the closing character must be followed by
whitespace, a closing sentence character (".", "!", "?", ",", ":",
";", etc) or the end-of-paragraph.

Valid inline formatting tags are "/" for emphasis, "*" for strong, "_"
for underline, "-" for strikethrough, and "{}" for typewriter font.

Conformance Note:: Underline and strikethrough tags are not allowed in
the strict variants of HTML.

Example::

  | A -big- /small/ sample paragraph with *simple* text _formatting_
  | and a bit of {typewriter} font.

HTML Output::

  {{
    <div class="sample">
      <p>A <strike>big</strike> <em>small</em> sample paragraph with
      <strong>simple</strong> text <u>formatting</u> and a bit of
      <tt>typewriter</tt> font.</p>
    </div>
  }}


=== Links ===

Links are generated with the "[target]" syntax.  A link can point to
other sections in the same document (see also [#Sections]), external
objects, and images.  A heuristic decides how the link is generated.

If the heuristic goes wrong, the link type can be set explicitly by
adding a control character after the opening bracket.  The "[>url]"
syntax indicates an external link, "[#section]" indicates an internal
link, and "[=image]" includes the image directly.

A link or image description can be specified by adding a vertical
bar ("|") and the description after the link target.  If no link
description is given, the target will be used.

Incomplete link targets are automatically completed by adding
"http://" or "mailto:".

Example::

  | This is a simple [http://nowhere.org/|link].  Another link to
  | [google.com].

HTML Output::

  {{
    <div class="sample">
      This is a simple <a href="http://nowhere.org/">link</a>.  Another
      link to <a href="http://google.com/">google.com</a>.
    </div>
  }}


=== Verbatim Text ===

A section of text enclosed in a double pair of curly braces is copied
verbatim to the output, without replacing markup or HTML control
characters.

Example::

  | <em>substituted</em> and {{<em>verbatim *stuff*</em>}}

HTML Output::

  {{
    <div class="sample">
      &lt;em&gt;substituted&lt;/em&gt; and <em>verbatim *stuff*</em>
    </div>
  }}


== Paragraphs and Paragraph-like Blocks ==

There are different types of paragraphs.  The type of each paragraph
can be determined from its first line.


=== Ordinary Paragraphs ===

Text in ordinary paragraphs is subject to automatic line breaking, and
may be formatted using inline markup.  Ordinary paragraphs can
optionally contain a paragraph heading.

Paragraphs end with a single empty line, or when a line with less
indentation than the paragraph is encountered.

If the first line of a paragraph contains two colons in a row ("::"),
the text before is taken to be the paragraph heading.  If the heading
is directly followed by a newline, the heading will stand on a line by
itself in the output, otherwise it will be followed directly by the
paragraph text.

Example::

  | First simple paragraph.
  |
  | Heading::
  | A lot of text in the second paragraph.

HTML Output::

  {{
    <div class="sample">
      <p>First simple paragraph.</p>
      <p><b>Heading</b><br />
      A lot of text in the second paragraph.</p>
    </div>
  }}


=== Preformatted Blocks ===

Text in preformatted blocks in not subject automatic line breaking and
is set using a typewriter font.  It can, however, still be formatted
using inline markup.

Preformatted blocks start with a single curly, opening brace ("{"),
followed by a space or line break, and ends with a single curly,
closing brace ("}"), followed by a line break.

Contained lines must be indented at least as far as the opening brace.

Example::

  | {
  |   Hi there!
  |           ^-- *exclamation mark*
  | }

HTML Output::

  {{
    <div class="sample">
  <pre>Hi there!
          ^-- <strong>exclamation mark</strong></pre>
    </div>
  }}


=== Code Blocks ===

Code blocks contain material like source code or shell session
records.  The content is not subject to automatic line breaking, and
inline markup is not recognized.  The output is set using a typewriter
font.

Code blocks are indented with vertical bars ("|") or exclamation marks
("!").  The indentation can be omitted if the text block is introduced
by "(code)" and terminated by "(end)", each on a line by itself.

Example::

  | | +------+
  | | | w00t |
  | | +------+


HTML output::

  {{
    <div class="sample">
  <pre>+------+
  | w00t |
  +------+</pre>
    </div>
  }}


=== Tables ===

Tabular material is delimited by a line containing only plus- ("+") and
minus-signs ("-") at the front, and an empty line at the end.  The
starting line must start and end with a plus-sign.

Every line (except for separator lines) corresponds to a single table
row.  Table cells are separated by vertical bars ("|").  Cells spanning
multiple columns can be specified by repeating the delimiter.

The table can optionally include separator lines, consisting of only
plus- and minus-signs.  A trailing separator line (if any) is discarded
entirely.  Separator lines inside the table mark the previous row as a
table heading.  The separator line itself is still discarded.

Example::

  | +---------------+--------------+
  | | Effect        | Markup       |
  | +---------------+--------------+
  | | Emphasis      | /some words/ |
  | | Strong        | *some words* |
  | | Typewriter    | {some words} |
  | | Underline     | _some words_ |
  | | Strikethrough | -some words- |
  | +---------------+--------------+

HTML Output::

  {{
    <div class="sample">
      <table>
        <tr><th>Effect</th><th>Markup</th></tr>
        <tr><td>Emphasis</td><td><em>some words</em></td></tr>
        <tr><td>Strong</td><td><strong>some words</strong></td></tr>
        <tr><td>Typewriter</td><td><tt>some words</tt></td></tr>
        <tr><td>Underline</td><td><u>some words</u></td></tr>
        <tr><td>Strikethrough</td><td><strike>some words</strike></td></tr>
      </table>
    </div>
  }}


=== Horizontal Rules ===

A line consisting of three or more dashes ("-"), followed immediately
by a newline, generates a horizontal rule.

Example::

  | ---

HTML Output::

  {{
    <div class="sample">
      <hr />
    </div>
  }}


=== Verbatim Blocks ===

Verbatim blocks are used to encapsulate code already in the output
format.  The complete block is copied verbatim to the output.

Verbatim blocks start with two curly, opening braces ("{{"), followend
by a space or line break, and end with two curly, closing braces
("}}"), followed by a line break.

Contained lines must be indented at least as far as the opening
braces.

Example::

  | {{
  |   <address>Me, Myself and I, no@whe.re</address>
  | }}

HTML Output::

  {{
    <div class="sample">
      <address>Me, Myself and I, no@whe.re</address>
    </div>
  }}


== Alternative Block Syntax ==

All paragraph-like blocks can also be written using a single, unified
syntax.

A block begins with the block type, optionally preceded by the word
"begin" and a list of modifier words, written in parentheses ("(" and
")") on a line by itself.  A block ends with the word "end",
optionally followed by the block type, in parentheses on a line by
itself.

Thus

  | (code)
  | void* memfrob(void* s, size_t n);
  | (end)

is equivalent to

  | | void* memfrob(void* s, size_t n);

Comment blocks are only available using this alternative syntax.
Comments are skipped completely when converting to html.

Example::

  | (comment)
  | business secret in here
  | (end)


== Environments ==

Environment markup is only recognized at the beginning of a new
paragraph.  The environment markup must be separated from the
paragraph text by at least one space or line break.  This is necessary
to disambiguate certain environments from inline markup, and is
required for other environments for consistency.

List markup is handled a bit differently to faciliate compact lists of
short items. If the previous paragraph was part of a list environment
of the same type, the paragraph separating empty line may be omitted.

Example::

  | * item 1
  | * item 2
  | * item 3


=== Quotations ===

A paragraph starting with a greater-than sign (">") introduces a
quotation.  Subsequent paragraphs belong to the same item as long as
they don't introduce another environment and are indented (at least)
as far as the starting paragraph.

Quotations can contain all types of paragraphs and other environments.

Contrasting to other environments, the markup character can be
repeated on every line of the quoted text.

Example::

  | > A language that doesn't affect the way you think about
  | > programming, is not worth knowing.
  |
  | -- Alan Perlis

HTML Output::

  {{
    <div class="sample">
      <blockquote><p>A language that doesn't affect the way you think
      about programming, is not worth knowing.</p></blockquote>

      <p>-- Alan Perlis</p>
    </div>
  }}


=== Bullet Lists ===

A paragraph starting with an asterisk ("*"), a dash ("-") or a small O
("o"), followed by a space or line break, starts a new bullet list
item.  Subsequent paragraphs belong to the same item as long as they
don't introduce another environment and are indented (at least) as far
as the starting paragraph.

Two bullet list paragraphs that both introduce a new list item, do not
need to be separated by two line breaks in a row.

All item in a bullet list must use the same bullet character.

Example::

  | * item 1
  | * item 2
  | * item 3

HTML Output::

  {{
    <div class="sample">
      <ul>
        <li><p>item 1</p></li>
        <li><p>item 2</p></li>
        <li><p>item 3</p></li>
      </ul>
    </div>
  }}


=== Numbered Lists ===

A paragraph starting with a hash mark ("#") followed by a space or
line break, starts a new numbered list item.  Subsequent paragraphs
belong to the same item as long as they don't introduce another
environment and are indented (at least) as far as the starting
paragraph.

Instead of a hash mark, a numbered list item may also be introduced
with a number, followed by a closing parenthesis (")"), or a dot
(".").

Two numbered list paragraphs that both introduce a new list item, do
not need to be separated by two line breaks in a row.

Example::

  | # item 1
  | # item 2
  | # item 3

HTML Output::

  {{
    <div class="sample">
      <ol>
        <li><p>item 1</p></li>
        <li><p>item 2</p></li>
        <li><p>item 3</p></li>
      </ol>
    </div>
  }}


=== Definition Lists ===

A paragraph starting with a colon (":") starts a new definition list
item.  The term and the definition text are separated by another
colon, followed by a space or linebreak.  Subsequent paragraphs belong
to the same item as long as they don't introduce another environment
and are indented (at least) as far as the starting paragraph.

Two definition list paragraphs that both introduce a new list item, do
not need to be separated by two line breaks in a row.

Example::

  | :some words: definition
  | :other words: a longer
  |   definition
  | :a very long term:
  |   definition begins here

HTML Output::

  {{
    <div class="sample">
      <dl>
        <dt>some words</dt>
        <dd><p>definition</p></dd>
        <dt>other words</dt>
        <dd><p>a longer definition</p></dd>
        <dt>a very long term</dt>
        <dd><p>definitition begins here</p></dd>
      </dl>
    </div>
  }}


== Sections ==

Sections consist of a heading, followed by a list of environments or
paragraphs.

The heading begins with one or more equal-signs ("=") and ends with an
empty line, or the same number of equal-signs at the end of a line.
The number of equal-signs indicates the level of the section.

The heading can optionally contain square brackets after the opening,
and before the trailing row of equal-signs, to indicate that the
heading is only structural, and should not be visible in the output.

In HTML output, headings automatically include an anchor tag, that can
be used to link to the section, using the heading as link target.
Invisible headings produce only an achor tag.

Example::

  | = heading level 1 =
  |
  | == heading level 2 ==
  |
  | ==[ invisible heading ]==

HTML Output::

  {{
    <div class="sample">
      <a name="heading_level_1"></a>
      <h1>heading level 1</h1>

      <a name="heading_level_2"></a>
      <h2>heading level 2</h2>

      <a name="invisible_heading"></a>
    </div>
  }}
